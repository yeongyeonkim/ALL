### ElastiCache

> 분산 인 메모리 캐시를 손쉽게 생성하고 확장할 수 있는 서비스 (인 메모리 키-값 저장소)

읽기 중심의 서비스(소셜 네트워크, 게임, 추천 엔진 등)을 제공하는 환경, 고속으로 데이터를 분석해야 하는 환경에 사용

* 동일한 VPC 내부의 인스턴스를 제외한 외부 네트워크에서 접속할 수 없다.

---

### Redis vs Memcached

> Redis는 다양한 용도에 효과적인 엔진, Memcached는 명료하고 단순한 엔진

#### 공통점

1. 응답 대기시간 
   - 1ms 이하의 응답시간을 제공한다. 데이터를 메모리에 저장하기 때문에 디스크 기반의 DB보다 빠르게 데이터를 읽을 수 있다.
2. 데이터 파티셔닝(Partitioning)
   * 데이터를 여러 노드에 분산하여 저장할 수 있다. 따라서 수요가 증가할 때 더 많은 데이터를 효과적으로 처리하기 위하여 scale out이 가능하다.

#### 차이점

##### Redis

* 다양한 데이터 구조
  * 문자열 뿐만 아니라 List, Set, Hash 등을 지원
* Snapshot
  * 특정 시점의 데이터를 디스크에 저장하여 파일 보관이 가능하며 장애 상황 시 복구에 사용할 수 있다.
* 복제
  * Master - Slave 구조로 여러 개의 복제본을 통해 데이터 베이스 읽기를 확장하여 높은 가용성 클러스터를 제공
* Pub/Sub
  * 높은 성능을 요구하는 채팅, 실시간 스트리밍과 같은 서버 상호 통신에 사용 가능

> Redis는 싱글 스레드로 1번에 1개의 명령어만 실행할 수 있다. Keys, flushall과 같이 데이터 전체를 확인, 삭제하는 명령어의 경우 Memcached는 1ms 소요, Redis는 100만 건의 데이터 기준 1초로 큰 속도 차이가 발생

> 또한, 특정 간격마다 모든 데이터를 디스크에 저장하는 RDB 작업이 오래 걸리게 된다. (Redis의 주요 장애 원인)

-> 데이터 변경이 잦기 때문에 실제 메모리 양만큼의 메모리를 자식 프로세스가 복사하게 된다. 따라서, 실제로 필요한 메모리 양보다 더 많은 메모리를 사용하게 된다.

##### Memcached 

* HTML 코드 조각과 같이 상대적으로 작고 정적인 데이터를 캐싱할 때 선호
* 유일하게 '문자열' 데이터 유형만 지원

* 멀티 스레드를 지원하여 scale up을 통한 많은 작업 처리가 가능
* LRU 삭제 정책 

---

#### Redis 메모리 관리 방식 비교 (AOF vs RDB)

> AOF를 기본으로, RDB를 옵션으로 사용

##### AOF (Append Only File)

* 입력/수정/삭제 명령이 실행될 때 마다 기록된다. (조회 x)
  * 이와 같은 Event 들을 로그에 남겨서 이를 기반으로 복구하는 방식

##### RDB (Redis Database)

* Redis 인스턴스의 현재 메모리에 대한 Snapshot을 생성하는 기능

* AOF 파일보다 사이즈가 작아, 로딩 속도가 빠르다.

* 저장 시점은 redis.conf의 save 파라미터로 설정

  * `save 900 1` : 900초 동안 1번 이상 key 변경 발생 시 저장

  