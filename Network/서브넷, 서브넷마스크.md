## IP 클래스의 비효율성

* 클래스 B를 어느 기업에 할당하는 경우 65000 여개의 아이피를 다 쓰는 것은 실질적으로 힘든데, 나머지 사용되지 않는 수많은 IP들은 해당 기업체가 점유하고 있는 상태. 그렇다고 클래스 C를 할당하자니 IP 자원이 너무 부족하게 된다.
  이러한 문제를 해결하기 위해 IP를 사용하는 네트워크 장치 수에 따라 효율적으로 사용할 수 있는 **서브넷**이 등장.

* A 클래스 0xxx xxxx. xxxx xxxx. xxxx xxxx. xxxx xxxxx
  * Network Address (0 ~ 127)   Host Address (0.0.0 ~ 255.255.255)
* B 클래스 10xx xxxx. xxxx xxxx. xxxx xxxx. xxxx xxxxx
  * Network Address (128.0 ~ 191. 255)   Host Address (0.0 ~ 255.255)
* C 클래스 110x xxxx. xxxx xxxx. xxxx xxxx. xxxx xxxxx
  * Network Address (192.0.0 ~ 255.255.255) Host Address (0 ~ 255)

## Subnet Mask

* 필요한 네트워크 주소만 호스트 IP로 할당 할 수 있게 만들어 네트워크 낭비를 방지.

* 예를 들어, IP가 192.168.0.1 이며 서브넷 마스크가 255.255.255.0 이라고 가정했을 때, AND 조건을 수행했을 시 나오는 것이 **Network ID** : 192.168.0.0 나머지는 Host를 식별하는 **Host ID**는 0

* 각 Network ID에서 첫번째 주소는 Network Address로 쓰이고 마지막 주소는 Broadcast로 쓰인다. 따라서 가장 첫번째 주소와 마지막 주소는 호스트에 할당할 수 없다.

* IP 주소 뒤에 /24 같은 것이 붙는 바로 이것은 **Prefix**(접두어)로 서브넷 마스크의 bit 수를 의미.

* 1개의 Bit씩 서브넷 마스크에 추가될 때 마다 네트워크 크기는 2배 증가하고 할당할 수 있는 호스트의 수는 2배 감소한다.

  EX) 기본 A클래스의 IP를 두 개의 서브넷으로 나누고 싶다.

  * /8에서 /9로 변하면, 서브넷 마스크가 255.0.0.0 에서 255.128.0.0으로 변하는 것</br>

    => A 클래스 망이 두 부분으로 나눠진다. Network ID가 116.0.0.0인 부분과 116.128.0.0으로.
  
* 라우터 : 네트워크 안에 서브넷을 나누는 물리적인 장치. 공인 IP주소를 할당받은 장치로서 서브넷 안의 호스트들이 외부망인 인터넷에 데이터를 송수신하는데 그 호스트가 가상 IP를 쓸 경우, NAT를 통해 서브넷 가상 IP로 바꾸어주어 외부 서버와 호스트와의 통신을 가능하게 해준다.</br>
  물론, 각 네트워크 ID가 같은 호스트들 끼리는 라우터를 통하지 않고도 바로 통신할 수 있다.

---------

## 서브넷팅의 이해

만약 A 클래스의 IP 주소 1.1.1.1을 그대로 할당하게 되면, Network ID가 1.0.0.0 Host ID가 0.1.1.1이 된다. 이때, Host ID의 범위는 0.0.0.0 ~ 0.255.255.255가 되어 할당 가능한 호스트 수가 16,777,216개(256 * 256 *  256)로 비효율적이다.

동일하게 A클래스 1.1.1.1을 할당하고, Subnet mask를 255.255.0.0으로 변경하면 Network ID는 1.0.0.0이 아닌 1.1.0.0으로 확장된 모습을 확인할 수 있다. Host ID는 0.1.1.1이 아닌 0.0.1.1로 변경.
이때, Host ID의 범위는 0.0.0.0 ~ 0.0.255.255가 되어 65,534개(256 * 256)의 호스트를 할당할 수 있게 되고 기존의 IP를 그대로 사용하는 것보다 훨씬 효율적이다.

----------

## 서브넷팅 계산 방법

예를 들어, 192.168.137.123/25는 /25의 서브넷 마스크를 가집니다. 서브넷 마스크가 25bit라는 의미로 255.255.255.128이 됩니다.(8+8+8+1) 그럼 호스트에 IP를 할당할 수 있는 범위가 [0~127], [128~255]가 되며, 네트워크는 [192.168.137.0], [192.168.137.128] 2개로 나누어지게 된다. 결국 192.168.137.23/25가 속한 네트워크는 192.168.137.0/25 대역에 속하게 되며, 다른 서브넷팅 된 네트워크와는 **라우터**를 통해서만 대신할 수 있다.

만약, 218.128.32.0/24 라는 네트워크 주소 하나를 25개씩의 호스트가 있는 각각의 네트워크로 분할하려고 한다면, 먼저 서브넷 주소와 서브넷 마스크를 2진수로 바꾼다.

IP address      : 11011010.10000000.00100000.<u>00000000</u></br>
Subnet mask : 11111111.11111111.11111111.<u>00000000</u>

하나의 옥텟은 8bit로 이루어져있고, 하나의 bit는 2개의 정보를 표현할 수 있다.
25개의 호스트에 ip를 한 개씩 할당해주려면 한 네트워크 당 ip가 최소 25개 이상은 있어야 하므로, 5개의 bit가 필요하다(2^5 = 32)

218.128.32.**000|00000**

<--Network ID  | Host ID-->

호스트 부분의 5개의 bit로 표현할 수 있는 범위를 구해보면

0 ~ 31	  (218.128.32.0 ~ 218.128.32.31)</br>
32 ~ 63	  (218.128.32.32 ~ 218.128.32.63) </br>
…...... </br>
224 ~ 255  (218.128.32.224 ~ 218.128.32.255)

이 범위의 서브넷은 218.128.32.0 이라고 할 수 있고, prefix는 네트워크의 bit수가 3개가 더 늘었기 때문에 /24가 아닌 /27이 된다.(8+8+8+3)

-------

## VLSM (Variable Length Subnet Mask)

서브넷팅은 동일한 크기로 네트워크를 나누는 방식이고, VLSM은 동일하지 않은 크기로 나누는 방식.
'**다양한 길이의 서브넷 마스크**' 라는 뜻

예를 들어, 한 회사에 A, B, C 라는 세 개의 부서가 있고 그 부서마다 사용하는 호스트의 수가 다르다고 하자. </br>
A 부서 : 100개의 Host </br>
B 부서 : 25개의 Host </br>
C 부서 : 2개의 Host </br>

서브넷팅을 할 때는 큰 범위부터 자르는 것이 효율적이다.

예제 IP : 200.1.1.0/24

**A 부서** : 필요한 IP 개수 총 102개</br>
	102개의 IP를 생성하기 위해 필요한 bit 수 = 7 bit (128)</br>
	200.1.1.**0|0000000**</br>
	200.1.1.**0|1111111**</br>
	Network ID : 200.1.1.0/25 (8+8+8+1)</br>
	IP 범위 : 200.1.1.0 ~ 200.1.1.127

**B 부서** : 필요한 IP 개수 총 27개</br>
	27개의 IP를 생성하기 위해 필요한 bit 수 = 5 bit (32)</br>
	200.1.1.**000|00000**</br>
	200.1.1.**111|11111**</br>
	Network ID : 200.1.1.0/27 (8+8+8+3)</br>
	IP 범위 : 200.1.1.128 ~ 200.1.1.159

**C 부서** : 필요한 IP 개수 총 4개</br>
	4개의 IP를 생성하기 위해 필요한 bit 수 = 2 bit (4)</br>
	200.1.1.**000000|00**</br>
	200.1.1.**111111|11**</br>
	Network ID : 200.1.1.0/30 (8+8+8+6)</br>
	IP 범위 : 200.1.1.160 ~ 200.1.1.163

------------

## CIDR(=Prefix)

도메인간의 라우팅에 사용되는 인터넷 주소를, 원래 IP 주소 클래스 체계를 쓰는 것보다 더욱 능동적으로 할 수 있도록 할당하여 지정하는 방식

인터넷 프로토콜은 A Class 에서 D Class 까지 4개의 클래스 내에서 IP 주소를 정의하게 됩니다.

255.255.255.192</br>
255 - 192 = 63</br>
Broad Cast : 192.168.32.63</br>
IP 주소 영역 : 192.168.32.1 ~ 192.168.32.62</br>

Broadcast : 송신 호스트가 전송한 데이터가 네트워크에 연결된 모든 호스트에 전송되는 방식.</br>

예를 들어, 1.1.1.1/32는 좌측부터 32비트가 전부 Net ID라는 것

